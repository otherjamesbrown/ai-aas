{
  "label": "${environment}-firewall",
  "inbound": [
    %{ for cidr in ingress ~}
    {
      "protocol": "TCP",
      "ports": "80-443",
      "addresses": {
        "ipv4": ["${cidr}"],
        "ipv6": ["::/0"]
      }
    },
    %{ endfor ~}
    {
      "protocol": "TCP",
      "ports": "22",
      "addresses": {
        "ipv4": ["0.0.0.0/0"],
        "ipv6": ["::/0"]
      }
    }
  ],
  "outbound": [
    %{ for cidr in egress ~}
    {
      "protocol": "TCP",
      "ports": "0-65535",
      "addresses": {
        "ipv4": ["${cidr}"],
        "ipv6": ["::/0"]
      }
    },
    %{ endfor ~}
    {
      "protocol": "UDP",
      "ports": "0-65535",
      "addresses": {
        "ipv4": ["0.0.0.0/0"],
        "ipv6": ["::/0"]
      }
    }
  ]
}
